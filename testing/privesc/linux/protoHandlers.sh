#!/bin/bash
#
# Find Ubuntu based Application Handlers on the system
# Can be used for privesc / client side attacks
#****************************************************
# ** Sometimes can reveal local exploits that 
# ** can be exploited remotely due to configuration
# ** Look into Blended Attacks in:
#    Hacking: The Next Generation
#    ----------------------------
######################################################

gconftool-2 /desktop/gnome/url-handlers --all-dirs | cut -d'/' -f5 | while read line;

do {
	gconftool-2 /desktop/gnome/url-handlers/$line -a | grep -i 'command' | cut -d'=' -f2 | while read line2;
	
	do {
		echo "$line : $line2"
	} done
} done
