---
description: Tools and Resources to setup attack infrastructure
---

# Tools

Different from pentesting, which focuses on a limited scope being probed for all possible vulnerabilities and attacks, Red Team engagements have a bit of a different focus. A Red Team is designed to act as a malicious adversary and attack the client with \(for the most part\) no rules to guage how effective their overall security plan actually is in a real world scenario.

Since an attack campaign like this can last as long as 6 months, there are a few tools and infrastructure to setup that will help that would not be as useful in a pentesting scenario.

## VPS Hosting Services

{% embed data="{\"url\":\"https://www.digitalocean.com/products/compute\",\"type\":\"link\",\"title\":\"Droplets on DigitalOcean - More than just virtual machines\",\"description\":\"Droplets are a scalable platform of compute instances with add-on storage, security, and monitoring capabilities to easily run production applications.\",\"icon\":{\"type\":\"icon\",\"url\":\"https://www.digitalocean.com/apple-touch-icon.png\",\"aspectRatio\":0},\"thumbnail\":{\"type\":\"thumbnail\",\"url\":\"https://www.digitalocean.com/assets/media/products/droplets/droplets-social-a75e1977.png\",\"width\":2048,\"height\":1024,\"aspectRatio\":0.5}}" %}

{% embed data="{\"url\":\"https://lightsail.aws.amazon.com\",\"type\":\"link\",\"icon\":{\"type\":\"icon\",\"url\":\"https://lightsail.aws.amazon.com/favicon.ico\",\"aspectRatio\":0}}" %}

Both of these services allow you to easily create and deploy Command and Control servers at little \(if no\) cost.

## Scripts, Tools, etc.

A quick way to install all of the tools you need is with TrustedSec's PenTesters Framework on github.

`$ git clone https://github.com/trustedsec/ptf.git`

PTF includes modules which can be used to install most tools you might need

```text
$ cd ptf && ./ptf

$ use modules/exploitation/install_update_all

etc...
```

{% hint style="info" %}
Remember to setup IPTables rules!
{% endhint %}

### More useful tools

Powershell Empire - a post-exploitation powershell framework

Unicorn - a useful tool by trustedsec for creating obfuscated powershell payloads.

```text
$ git clone https://github.com/trustedsec/unicorn.git

$ git clone https://github.com/EmpireProject/Empire.git
```

## Domain Fronting

Command and Control Servers can be hidden behind well known domains by using popular CDNs \(Content Delivery Networks\) as redirectors to your server, masking the origin of the traffic.

* Amazon's CloudFront
* Google Hosts

\*\* socat can be used to setup the redirectors for domain fronting

#### Further Reading

{% embed data="{\"url\":\"http://bit.ly/2Hn7RW4\",\"type\":\"link\",\"title\":\"Red Team Insights on HTTPS Domain Fronting Google Hosts Using Cobalt Strike - CyberArk\",\"description\":\"In this blog post, we will cover HTTPS domain fronting Google hosts \(google.com, mail.google.com, etc.\) using Cobalt Strike. Domain fronting via google.com has been used by adversaries, and it is valuable to include as part of Red Team assessments. Domain Fronting is a technique to hide the remote endpoint of communication while leveraging high reputation …\",\"icon\":{\"type\":\"icon\",\"url\":\"https://www.cyberark.com/wp-content/themes/altitude-pro/images/favicon.ico\",\"aspectRatio\":0},\"thumbnail\":{\"type\":\"thumbnail\",\"url\":\"https://www.cyberark.com/wp-content/uploads/2017/07/laser.jpg\",\"width\":1223,\"height\":682,\"aspectRatio\":0.5576451349141456}}" %}

{% embed data="{\"url\":\"http://bit.ly/2HjM3eH\",\"type\":\"link\",\"title\":\"Alibaba CDN Domain Fronting\",\"description\":\"Author: @vysecurity\",\"icon\":{\"type\":\"icon\",\"url\":\"https://cdn-images-1.medium.com/fit/c/304/304/1\*8I-HPL0bfoIzGied-dzOvA.png\",\"width\":152,\"height\":152,\"aspectRatio\":1},\"thumbnail\":{\"type\":\"thumbnail\",\"url\":\"https://cdn-images-1.medium.com/max/2000/1\*jVsYEFqXf21i18VDbm0UNQ.png\",\"width\":1072,\"height\":797,\"aspectRatio\":0.7434701492537313}}" %}

{% embed data="{\"url\":\"https://bitrot.sh/post/30-11-2017-domain-fronting-with-meterpreter/\",\"type\":\"link\",\"title\":\"Domain Fronting with Meterpreter\",\"description\":\"Domain Fronting is a technique that is typically used for censorship evasion. It relies on popular Content Delivery Networks \(CDNs\) such as Amazon’s CloudFront to mask traffic origins. By changing the HTTP Host header, the CDN will happily route us to the correct server. Red Teams have been using this technique for hiding C2 traffic by using high reputation redirectors.  For more information on Domain Fronting, please refer to this whitepaper\",\"icon\":{\"type\":\"icon\",\"url\":\"https://bitrot.sh/images/favicon.ico\",\"aspectRatio\":0},\"thumbnail\":{\"type\":\"thumbnail\",\"url\":\"https://bitrot.sh/images/logo.png\",\"width\":512,\"height\":512,\"aspectRatio\":1}}" %}

## Tunneling C2 Shells

### dns**cat2** 

A tool for tunneling C2 connections over the DNS protocol

```text
$ git clone https://github.com/iagox86/dnscat2.git
** you need an authoritative dns server
```

You can even tunnel an SSH conneciton through dnscat

```text
dnscat2> listen 127.0.0.1:4444 10.10.1.5:22

$ ssh root@localhost -p 4444
```

### ICMP tunnels

Nishang can be used with icmpsh as the C2 server for a powershell based icmp tunnelled connection

{% embed data="{\"url\":\"http://bit.ly/2GXhdnZ\",\"type\":\"link\",\"title\":\"samratashok/nishang\",\"description\":\"nishang - Nishang - Offensive PowerShell for penetration testing and offensive security.\",\"icon\":{\"type\":\"icon\",\"url\":\"https://github.com/fluidicon.png\",\"aspectRatio\":0},\"thumbnail\":{\"type\":\"thumbnail\",\"url\":\"https://avatars1.githubusercontent.com/u/1753291?s=400&v=4\",\"width\":400,\"height\":400,\"aspectRatio\":1}}" %}

```text
$ git clone https://github.com/inquisb/icmpsh.git
```

Other icmp shells include:

```text
$ git clone https://github.com/jamesbarlow/icmptunnel.git

$ git clone https://github.com/DhavalKapil/icmptunnel.git
```

{% embed data="{\"url\":\"http://code.gerade.org/hans/\",\"type\":\"link\",\"title\":\"Hans - IP over ICMP\"}" %}

### PoshC2

Proxy aware C2 powershell framework

```text
$ git clone https://github.com/nettitude/PoshC2.git
```

