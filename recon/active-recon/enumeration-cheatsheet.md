# Enumeration CheatSheet

## Step 1: Basic Nmap Scans

```text
$ nmap -Pn -sT -T4 -p- --open <RHOST>

# Quick common Ports scan
$ nmap -sV -A --top-ports 20 --open <RHOST>
```

##  2: Nmap Enumeration and Vulnerability Scans:

Run against ports found from the initial scan of all ports

```text
$ nmap -sV --version-all -A -pT:{TCP Ports},U:{UDP Ports} <RHOST>

$ nmap -sV -pT:{TCP Ports},U:{UDP Ports} --script vuln <RHOST>
```

It is also helpful to run any service specific nse scripts against open ports found on the target

```text
$ alias nse='ls /usr/share/nmap/scripts'

$ nse | grep ftp
$ nse | grep http
$ nse | grep smb-vuln
```

## Step 3: Enumerate Any Web Services Found

Tip: You need to input http/https and RPORT as needed  based on the service you are trying to scan. Default for http is port 80, default for https is port 443.

```text
$ nikto -C all -h http(s)://<RHOST>:RPORT>

$ gobuster -u http://<RHOST> -w /usr/share/seclists/Discovery/Web_Content/common.txt -s "200,403,500" -e

$ dirb http(s)://<RHOST>
```

Use Burpsuite as needed

Do you see any interesting directories containing sensitive data?

Did Nikto find any possible LFI/RFI vulnerabilities? 

Try fimap: `$ fimap -u`

## Step 4: Check ALL Discovered Services For Public Exploits

 You may have to play around with the wording a little.

Ex. if the service is Samba 3.0.4 you could try:  Samba;  Samba 3.0;  Samba 3;  Samba 3.x

```text
$ searchsploit <service-name> | grep -v '/dos/'
```

If a possible exploit is found, find the file based on the exploitdb number in the far right column:

```text
Example:
root@kali:~# searchsploit Samba 3.0
----------------------------------------------------------------------------------------------- ----------------------------------------
 Exploit Title                                                                                 |  Path
                                                                                               | (/usr/share/exploitdb/)
----------------------------------------------------------------------------------------------- ----------------------------------------
Samba 3.0.10 (OSX) - 'lsa_io_trans_names' Heap Overflow (Metasploit)                           | exploits/osx/remote/16875.rb
Samba 3.0.10 < 3.3.5 - Format String / Security Bypass                                         | exploits/multiple/remote/10095.txt
Samba 3.0.20 < 3.0.25rc3 - 'Username' map script' Command Execution (Metasploit)               | exploits/unix/remote/16320.rb
Samba 3.0.21 < 3.0.24 - LSA trans names Heap Overflow (Metasploit)                             | exploits/linux/remote/9950.rb
Samba 3.0.24 (Linux) - 'lsa_io_trans_names' Heap Overflow (Metasploit)                         | exploits/linux/remote/16859.rb
Samba 3.0.24 (Solaris) - 'lsa_io_trans_names' Heap Overflow (Metasploit)                       | exploits/solaris/remote/16329.rb
Samba 3.0.27a - 'send_mailslot()' Remote Buffer Overflow                                       | exploits/linux/dos/4732.c
Samba 3.0.29 (Client) - 'receive_smb_raw()' Buffer Overflow (PoC)                              | exploits/multiple/dos/5712.pl
Samba 3.0.4 - SWAT Authorisation Buffer Overflow                                               | exploits/linux/remote/364.pl
Samba < 3.0.20 - Remote Heap Overflow                                                          | exploits/linux/remote/7701.txt
----------------------------------------------------------------------------------------------- ----------------------------------------

$ locate exploits/linux/remote/364.pl
/usr/share/exploitdb/exploits/linux/remote/364.pl

$ cp /usr/share/exploitdb/exploits/linux/remote/364.pl ./sambaSWAT-bof.pl
```

[http://www.securityfocus.com/vulnerabilities](http://www.securityfocus.com/vulnerabilities)

## Step 5: Manual Poking for Web Pages

Check the Page Source, Inspect elements, view cookies, tamper data, use curl/wget

```text
Google alien terms!
Anything sensitive there?
Any version info?
```

If the web application is open source, check its github repo! You might be able to find where credentials are stored, configuration files, general layout of the site, and possibly determine the version in use.

Check HTTP Options

Check for Input Validation in forms \(like: 1′ or 1=1 limit 1;\# AND 1′ or 1=1–\)

```text
NULL or null
    Possible error messages returned.

‘ , ” , ; , <!
    Breaks a SQL string or query; used for SQL, XPath and XML Injection tests.

– , = , + , ”
    Used to craft SQL Injection queries.

‘ , &, ! , ¦ , < , >
    Used to find command execution vulnerabilities.

../
    Directory Traversal Vulnerabilities.
```

## Step 6: NETBIOS, SMB, or RPC Services?

```text
$ enum4linux -a <RHOST>

$ rpcclient -U '' -N <RHOST>

$ rpcinfo -p <RHOST>
```

Take note if portmapper, rlogin, NFS, or Mountd are found running on the target.

{% embed data="{\"url\":\"http://etutorials.org/Networking/network+security+assessment/Chapter+12.+Assessing+Unix+RPC+Services/12.2+RPC+Service+Vulnerabilities/\",\"type\":\"link\",\"title\":\"12.2 RPC Service Vulnerabilities :: Chapter 12. Assessing Unix RPC Services :: Network security assessment :: Networking :: eTutorials.org\",\"icon\":{\"type\":\"icon\",\"url\":\"http://etutorials.org/favicon.ico\",\"aspectRatio\":0}}" %}

#### Check for NFS Shares

```text
$ showmount -e <RHOST>:/
```

#### Mount NFS Share Locally

```text
$ mount -t nfs <RHOST>:/ /mnt
```

#### Mount SMB Share Locally

```text
$ mount -t cifs //<RHOST>/<Share> -o username="guest",password=""
```

#### Interact With Remote SMB Share

```text
$ smbclient -L //<RHOST> -N

$ smbclient //<RHOST>/<Share> -U 'guest' -P 'pass' -W <domain/workgroup>
```

#### Windows utilities to interact with SMB Shares

```text
C:\> nbtscan  -r

C:\> net use \\<RHOST>\$<Share> "" /u:""

C:\> net view \
```

{% hint style="info" %}
Remember to run nmap scripts for SMB, DCERPC, and NETBIOS against discovered ports!
{% endhint %}

## Step 7: Was an SMTP Service Found?

Enumerate Users:

Mail Server Testing

```text
Enumerate users
    VRFY username (verifies if username exists – enumeration of accounts)
    EXPN username (verifies if username is valid – enumeration of accounts)
```

### Step 8: SNMP Enumeration - UDP Port 161

Default Community Names: public, private, cisco, manager

Enumerate MIB Tree:

```text
1.3.6.1.2.1.25.1.6.0 System Processes
1.3.6.1.2.1.25.4.2.1.2 Running Programs
1.3.6.1.2.1.25.4.2.1.4 Processes Path
1.3.6.1.2.1.25.2.3.1.4 Storage Units
1.3.6.1.2.1.25.6.3.1.2 Software Name
1.3.6.1.4.1.77.1.2.25 User Accounts
1.3.6.1.2.1.6.13.1.3 TCP Local Ports
```

#### Tools

```text
$ onesixtyone -c -l <RHOST>

$ snmpwalk -c public -v1 <RHOST> <mib-value>
```

## Step 9: Enumerating FTP

### Check for Anonymous Login

```text
$ ftp <RHOST> anonymous

$ nmap -sV -p21 --script ftp-anon <RHOST>
```

Directory Listing?  Can you read or write to the FTP share?

{% hint style="info" %}
Try viewing the ftp share with a web browser using:

ftp://&lt;RHOST&gt;/
{% endhint %}

## Step 10: Password Cracking / Brute Forcing

Save password cracking as more of a last resort.

### Linux Shadow File

```text
# The to put hashes in proper format for john the ripper
# both /etc/shadow and /etc/passwd are needed

$ unshadow <passwd-file> <shadow-file> > unshadowed.txt

$ john --rules --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt
```

Identifying Hash Type with: `hash-identifier`

### Brute Forcing Network Services

```text
$ hydra -L -P -v ssh

$ medusa -h -U -P -M http -m DIR:/admin -T 30
```

### Hashcat

```text
# Wordpress MD5 with salt
$ hashcat -m 400 -a 0
```

## Step 11: Packet Sniffing

Use Wireshark or tcpdump to capture network traffic on the target host:

```text
$ tcpdump -i tap0 host tcp port 80 and not arp and not icmp -vv
```



