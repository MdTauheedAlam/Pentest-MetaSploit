<?php
// Content
$header = json_encode(['typ' => 'JWT', 'alg' => 'HS256']);
$payload = json_encode(['user' => 'admin']);

// Proper encoding of content
$base64UrlHeader = str_replace(['+', '/', '='], ['-', '_', ''], base64_encode($header));
$base64UrlPayload = str_replace(['+', '/', '='], ['-', '_', ''], base64_encode($payload));

// Sign data to create 3rd Part of Token

//$prompt = "Enter JWT Encoding Secret: "               # These are for automation
//$secret = string readline ([ string $prompt]);

$signature = hash_hmac('sha256', $base64UrlHeader . "." . $base64UrlPayload, 'hacker', true);


// Base64 Encode the the signature
$base64UrlSig = str_replace(['+', '/', '='], ['-', '_', ''], base64_encode($signature));

// Create the token
$jwt = $base64UrlHeader + '.' + $base64UrlPayload + '.' + $base64UrlSig;


// Print Created token out to the command line
echo $jwt;

// Valid Signature to compare it to (user:null)
$valid = 'Tr0VvdP6rVBGBGuI_luxGCOaz6BbhC6IxRTlKOW8UjM';
echo $valid;

?>
